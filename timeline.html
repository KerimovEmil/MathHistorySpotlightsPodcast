<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Math History Spotlights Timeline</title>

<!-- favicon link -->
<link rel="shortcut icon" href="./favicon.svg" type="image/svg+xml">

<!-- custom css link -->
<link rel="stylesheet" href="./assets/css/style.css">

<!-- google font link -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@400;500;700&display=swap" rel="stylesheet">

<style>

  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    margin: 0;
    background: #fafafa;
  }

  h2 {
    margin: 20px 40px 0;
    font-weight: 600;
  }

  .controls {
    margin: 10px 40px;
  }

  .timeline-container {
    overflow-x: auto;
    padding: 30px 40px 50px;
  }

  .timeline {
    position: relative;
    height: 700px;
    transition: width 0.3s ease;
  }

  .axis {
    position: absolute;
    bottom: 80px;
    left: 0;
    right: 0;
    height: 2px;
    background: #ccc;
  }


  .year {
    position: absolute;
    bottom: 10px;
    font-size: 12px;
    color: #666;
    transform: translateX(-50%);
  }

  .person {
    position: absolute;
    height: 24px;
    border-radius: 8px;
    color: white;
    font-size: 12px;
    padding: 2px 8px;
    white-space: nowrap;
    cursor: pointer;
    opacity: 0;
    animation: fadeIn 0.6s forwards;
  }

  .person:hover {
    filter: brightness(1.1);
  }

  .tooltip {
    position: absolute;
    background: #111;
    color: #fff;
    padding: 8px 10px;
    font-size: 12px;
    border-radius: 6px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s ease;
    max-width: 240px;
    z-index: 10;
  }

  @keyframes fadeIn {
    to { opacity: 1; }
  }

  /* Era colors */
  .renaissance { background: #0ea5e9; }
  .enlightenment { background: #22c55e; }
  .classical { background: #6366f1; }
  .modern { background: #ef4444; }
</style>
</head>

<body id="top">

<!-- HEADER -->
<site-header></site-header>

<main>
  <article class="container">
    <h2>Math History Spotlights — Timeline</h2>


<div class="controls">
  Zoom:
  <input type="range" id="zoom" min="1200" max="2600" value="1800">
</div>

<div class="timeline-container">
  <div class="timeline" id="timeline">
    <div class="axis"></div>
  </div>
</div>

<div class="tooltip" id="tooltip"></div>

<script>
const timeline = document.getElementById("timeline");
const tooltip = document.getElementById("tooltip");
const zoom = document.getElementById("zoom");

let data = [];
let minYear = 0;
let maxYear = 0;

// Function to determine era based on birth year
function getEra(birthYear) {
  if (birthYear < 1600) return "renaissance";
  if (birthYear < 1750) return "enlightenment";
  if (birthYear < 1900) return "classical";
  return "modern";
}

// Function to parse episode title and extract mathematician data
function parseTitle(title) {
  // Try to extract name and years from patterns like:
  // "Leonhard Euler 1707 - 1783"
  // "Charles Babbage 1791 Augusta Ada Byron King, Countess of Lovelace 1815 - 1852"
  
  // Match pattern: name followed by year - year
  const match = title.match(/^(.+?)\s+(\d{4})\s*-\s*(\d{4})/);
  if (match) {
    return {
      name: match[1].trim(),
      b: parseInt(match[2]),
      d: parseInt(match[3])
    };
  }
  
  // Try alternative pattern for combined entries
  const match2 = title.match(/(\d{4})\s+(.+?)\s+(\d{4})\s*-\s*(\d{4})/);
  if (match2) {
    return {
      name: match2[2].trim(),
      b: parseInt(match2[3]),
      d: parseInt(match2[4])
    };
  }
  
  return null;
}

// Fetch and parse RSS feed
async function fetchEpisodes() {
  try {
    const response = await fetch('https://anchor.fm/s/10cdf4708/podcast/rss');
    const text = await response.text();
    const parser = new DOMParser();
    const xmlDoc = parser.parseFromString(text, "text/xml");
    
    const items = xmlDoc.querySelectorAll("item");
    const parsedData = [];
    
    items.forEach(item => {
      const titleElement = item.querySelector("title");
      if (titleElement) {
        const title = titleElement.textContent;
        const parsed = parseTitle(title);
        if (parsed) {
          parsedData.push({
            ...parsed,
            era: getEra(parsed.b),
            note: `Episode: ${title}`
          });
        }
      }
    });
    
    // Sort by birth year
    parsedData.sort((a, b) => a.b - b.b);
    
    data = parsedData;
    
    if (data.length > 0) {
      minYear = Math.min(...data.map(d => d.b));
      maxYear = Math.max(...data.map(d => d.d));
      render(+zoom.value);
    }
  } catch (error) {
    console.error("Error fetching episodes:", error);
    // Show error message
    timeline.innerHTML = '<div style="padding: 20px; color: #ef4444;">Failed to load episode data. Please check your connection.</div>';
  }
}

function render(width) {
  if (data.length === 0) return;
  
  timeline.style.width = width + "px";
  timeline.innerHTML = `<div class="axis"></div>`;

  const yearToX = y => ((y - minYear) / (maxYear - minYear)) * width;

  for (let y = minYear; y <= maxYear; y += 50) {
    const tick = document.createElement("div");
    tick.className = "year";
    tick.style.left = yearToX(y) + "px";
    tick.textContent = y;
    timeline.appendChild(tick);
  }

  data.forEach((p, i) => {
    const bar = document.createElement("div");
    bar.className = `person ${p.era}`;
    bar.style.left = yearToX(p.b) + "px";
    bar.style.width = (yearToX(p.d) - yearToX(p.b)) + "px";
    bar.style.top = (i * 28) + "px";
    bar.style.animationDelay = (i * 0.03) + "s";
    bar.textContent = `${p.name} (${p.b}–${p.d})`;

    bar.addEventListener("mousemove", e => {
      tooltip.style.opacity = 1;
      tooltip.style.left = e.pageX + 12 + "px";
      tooltip.style.top = e.pageY + 12 + "px";
      tooltip.innerHTML = `<strong>${p.name}</strong><br>${p.note}`;
    });

    bar.addEventListener("mouseleave", () => {
      tooltip.style.opacity = 0;
    });

    timeline.appendChild(bar);
  });
}

zoom.addEventListener("input", e => render(+e.target.value));

// Initialize by fetching episodes
fetchEpisodes();
</script>

  </article>
</main>

<!-- footer component -->
<site-footer></site-footer>

<!-- ionicon link -->
<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

<!-- web components -->
<script type="module" src="./assets/js/site-header.js"></script>
<script type="module" src="./assets/js/site-footer.js"></script>

</body>
</html>
